# 图书管理系统概要设计说明书

**1　引言**

## 1.1 编写目的

本概要设计说明书旨在详细描述图书管理系统的总体设计方案，包括系统架构、功能模块划分、接口设计、数据结构设计等内容。本文档主要面向系统开发人员、测试人员以及项目管理人员，为后续的详细设计和系统实现提供指导和依据。

## 1.2 背景

**系统名称**：图书管理系统

**任务提出者**：软件设计模式课程教师

**开发者**：软件设计模式课程学生

**用户**：图书馆管理员、图书馆读者

本系统旨在通过信息化手段提高图书馆的管理效率，实现图书资源的有效管理和利用。系统将采用多种设计模式，展示软件设计模式在实际应用中的价值。

## 1.3 定义

- **DAO (Data Access Object)**：数据访问对象，用于抽象和封装对数据源的访问。
- **UI (User Interface)**：用户界面，系统与用户交互的接口。
- **RFID (Radio Frequency Identification)**：射频识别，一种无线通信技术，用于图书标签识别。
- **ISBN (International Standard Book Number)**：国际标准书号，图书的唯一标识符。
- **PK (Primary Key)**：主键，数据库表中唯一标识记录的字段。
- **FK (Foreign Key)**：外键，用于建立和加强两个表数据之间的链接的字段。

## 1.4 参考资料

1. 《软件工程：实践者的研究方法》（第8版），Roger S. Pressman，机械工业出版社，2016年
2. 《设计模式：可复用面向对象软件的基础》，Erich Gamma等，机械工业出版社，2007年
3. 《Java编程思想》（第4版），Bruce Eckel，机械工业出版社，2007年
4. 《数据库系统概念》（第6版），Abraham Silberschatz等，机械工业出版社，2012年
5. 图书管理系统需求规格说明书

**2　总体设计**

## 2.1 需求规定

图书管理系统主要需求包括：

1. **图书管理**：实现图书的添加、删除、修改、查询、搜索等功能。
2. **用户管理**：支持用户注册、登录、权限管理等功能。
3. **借阅管理**：实现图书借阅、归还、续借、预约等功能。
4. **读者管理**：支持读者信息的添加、修改、查询等功能。
5. **统计分析**：提供借阅统计、图书流通率分析、读者活跃度分析等功能。
6. **系统管理**：包括系统配置、数据备份与恢复、日志管理等功能。

## 2.2 运行环境

### 硬件环境

- 服务器：CPU 2.0GHz以上，内存8GB以上，硬盘500GB以上
- 客户端：CPU 1.5GHz以上，内存4GB以上
- 外设：条码扫描器、打印机、RFID读卡器

### 软件环境

- 操作系统：服务器端Windows Server 2019或Linux，客户端Windows 10/11或macOS
- 数据库：MySQL 8.0或以上版本
- 开发环境：JDK 11或以上版本，Maven 3.6或以上版本
- 应用服务器：Tomcat 9.0或以上版本
- 浏览器：Chrome、Firefox、Edge等现代浏览器

## 2.3 基本设计概念和处理流程

### 基本设计概念

系统采用多层架构设计，包括表示层、业务逻辑层、数据访问层，并应用多种设计模式提高系统的可维护性、可扩展性和灵活性。系统将以面向对象的方式进行设计和实现，充分利用设计模式的优势。

### 处理流程

#### 系统功能结构图

```
图书管理系统
├── 用户认证模块
│   ├── 用户登录
│   ├── 用户注册
│   ├── 密码修改
│   └── 权限管理
├── 图书管理模块
│   ├── 图书添加
│   ├── 图书修改
│   ├── 图书删除
│   ├── 图书查询
│   └── 图书搜索
├── 读者管理模块
│   ├── 读者添加
│   ├── 读者修改
│   ├── 读者删除
│   └── 读者查询
├── 借阅管理模块
│   ├── 图书借阅
│   ├── 图书归还
│   ├── 图书续借
│   ├── 图书预约
│   └── 超期处理
├── 统计分析模块
│   ├── 借阅统计
│   ├── 图书流通率分析
│   └── 读者活跃度分析
└── 系统管理模块
    ├── 系统配置
    ├── 数据备份与恢复
    └── 日志管理
```

#### 主要业务流程图

1. **图书借阅流程**

```
读者 -> 登录系统 -> 搜索图书 -> 选择图书 -> 确认借阅 -> 系统记录借阅信息 -> 更新图书状态
```

2. **图书归还流程**

```
读者 -> 登录系统 -> 查看已借图书 -> 选择归还图书 -> 确认归还 -> 系统检查是否超期 -> 计算罚款(如有) -> 更新借阅记录 -> 更新图书状态
```

## 2.4 结构

### 系统模块划分

1. **用户认证模块**：负责用户登录、注册、密码修改和权限管理。
2. **图书管理模块**：负责图书的添加、修改、删除、查询和搜索。
3. **读者管理模块**：负责读者信息的添加、修改、删除和查询。
4. **借阅管理模块**：负责图书的借阅、归还、续借、预约和超期处理。
5. **统计分析模块**：负责借阅统计、图书流通率分析和读者活跃度分析。
6. **系统管理模块**：负责系统配置、数据备份与恢复和日志管理。

### 模块关系图

```
+----------------+      +----------------+      +----------------+
|  用户认证模块   | <--- |  系统管理模块   | ---> |  统计分析模块   |
+----------------+      +----------------+      +----------------+
        ^                      ^                      ^
        |                      |                      |
        v                      v                      v
+----------------+      +----------------+      +----------------+
|  图书管理模块   | <--- |  借阅管理模块   | ---> |  读者管理模块   |
+----------------+      +----------------+      +----------------+
```

## 2.5 功能与程序的关系

| 功能 | 相关程序模块 | 主要类 |
| --- | --- | --- |
| 用户认证 | 用户认证模块 | UserService, UserDao, User |
| 图书管理 | 图书管理模块 | BookService, BookDao, Book, BookSortStrategy |
| 读者管理 | 读者管理模块 | ReaderService, ReaderDao, Reader |
| 借阅管理 | 借阅管理模块 | BorrowService, BorrowDao, Borrow, Reservation |
| 统计分析 | 统计分析模块 | StatisticsService, ReportGenerator |
| 系统管理 | 系统管理模块 | SystemService, LogDao, ConfigurationManager |

## 2.6 人工处理过程

在系统运行过程中，以下环节需要人工处理：

1. **图书入库**：新书到馆后，管理员需要手动录入图书信息，贴上条码或RFID标签。
2. **读者注册审核**：新读者注册后，可能需要管理员进行身份审核和确认。
3. **图书损坏处理**：读者归还的图书如有损坏，需要管理员进行人工检查和记录。
4. **特殊借阅处理**：某些特殊情况下的借阅申请（如超出借阅限制、特殊读者权限等）需要管理员手动审批。
5. **系统数据备份**：虽然系统支持自动备份，但重要数据的备份可能需要管理员手动操作和确认。

## 2.7 尚未解决的问题

1. **多媒体资源管理**：当前系统主要针对传统图书资源，对于电子书、音频、视频等多媒体资源的管理尚未完全解决。
2. **分布式部署**：系统目前设计为单机部署，未来可能需要考虑分布式部署以提高系统性能和可用性。
3. **移动端适配**：系统当前主要面向PC端设计，移动端的适配和优化尚未完全解决。
4. **第三方系统集成**：与其他图书馆系统、学校管理系统等第三方系统的集成接口尚未完全定义。
5. **国际化支持**：系统当前主要支持中文，对多语言的支持尚未完全实现。

**3　接口设计**

## 3.1 用户接口

### 命令与操作

系统提供以下主要命令和操作：

1. **登录命令**：`login <username> <password>`
2. **图书查询命令**：`search book <keyword>`
3. **图书借阅命令**：`borrow <book_id>`
4. **图书归还命令**：`return <book_id>`
5. **读者查询命令**：`search reader <keyword>`
6. **系统帮助命令**：`help`
7. **退出系统命令**：`exit`

### 界面设计

系统界面采用直观、友好的设计风格，主要包括以下几个部分：

1. **登录界面**：提供用户名和密码输入框，以及登录按钮。
2. **主界面**：包含系统主要功能模块的导航菜单。
3. **图书管理界面**：提供图书的添加、修改、删除、查询和搜索功能。
4. **读者管理界面**：提供读者信息的添加、修改、删除和查询功能。
5. **借阅管理界面**：提供图书借阅、归还、续借、预约和超期处理功能。
6. **统计分析界面**：提供各类统计报表和分析图表。
7. **系统管理界面**：提供系统配置、数据备份与恢复和日志管理功能。

## 3.2 外部接口

### 硬件接口

1. **条码扫描器接口**：用于快速扫描图书条码，通过USB或蓝牙连接。
2. **打印机接口**：用于打印借书单、还书单、统计报表等，支持标准打印协议。
3. **RFID读卡器接口**：用于读取RFID标签，实现快速借还和盘点。

### 软件接口

1. **数据库接口**：系统通过JDBC与MySQL数据库进行交互。
2. **邮件服务接口**：系统通过SMTP协议发送邮件通知。
3. **短信服务接口**：系统通过HTTP API与短信服务提供商对接，发送短信通知。
4. **支付接口**：系统通过HTTP API与支付服务对接，处理罚款支付等。

## 3.3 内部接口

### 模块间接口

1. **用户认证模块与其他模块的接口**：提供用户身份验证和权限检查服务。
2. **图书管理模块与借阅管理模块的接口**：提供图书信息查询和状态更新服务。
3. **读者管理模块与借阅管理模块的接口**：提供读者信息查询和借阅权限检查服务。
4. **借阅管理模块与统计分析模块的接口**：提供借阅数据查询服务。
5. **系统管理模块与其他模块的接口**：提供系统配置参数和日志记录服务。

### 类图

```
+----------------+      +----------------+      +----------------+
|      User      |      |      Book      |      |     Reader     |
+----------------+      +----------------+      +----------------+
| -userId: Long  |      | -bookId: Long  |      | -readerId: Long|
| -username: String |   | -isbn: String  |      | -name: String  |
| -password: String |   | -title: String |      | -cardId: String|
| -role: String  |      | -author: String|      | -status: int   |
+----------------+      | -publisher: String |   | -userId: Long  |
| +login(): boolean |   | -status: int   |      +----------------+
| +logout(): void |     +----------------+      | +borrow(): boolean |
+----------------+      | +addBook(): void |     | +return(): boolean |
         ^               | +removeBook(): void |  +----------------+
         |               +----------------+               ^
         |                        ^                       |
         |                        |                       |
+----------------+      +----------------+      +----------------+
|    AdminUser   |      |     Borrow     |      | Reservation   |
+----------------+      +----------------+      +----------------+
| -adminId: Long |      | -borrowId: Long|      | -reservationId: Long |
+----------------+      | -bookId: Long  |      | -bookId: Long  |
| +manageBooks() |      | -readerId: Long|      | -readerId: Long|
| +manageReaders() |    | -borrowDate: Date |   | -reservationDate: Date |
+----------------+      | -dueDate: Date |      | -status: int   |
                        | -returnDate: Date |   +----------------+
                        | -status: int   |      | +reserve(): boolean |
                        +----------------+      | +cancel(): boolean |
                        | +borrow(): boolean |  +----------------+
                        | +return(): boolean |
                        | +renew(): boolean |
                        +----------------+
```

**4　运行设计**

## 4.1 运行模块组合

系统根据不同用户角色和操作需求，形成以下几种主要的运行模块组合：

1. **管理员操作组合**：用户认证模块 + 图书管理模块 + 读者管理模块 + 借阅管理模块 + 统计分析模块 + 系统管理模块
2. **普通管理员操作组合**：用户认证模块 + 图书管理模块 + 读者管理模块 + 借阅管理模块
3. **读者操作组合**：用户认证模块 + 图书查询功能 + 个人借阅管理功能
4. **游客操作组合**：图书查询功能

## 4.2 运行控制

### 用户登录流程

1. 用户输入用户名和密码
2. 系统验证用户身份
3. 验证成功后，根据用户角色加载相应的功能模块
4. 验证失败则提示错误信息，并允许重新输入

### 图书借阅流程

1. 读者登录系统
2. 搜索并找到需要借阅的图书
3. 选择图书并确认借阅
4. 系统检查图书状态和读者借阅权限
5. 符合借阅条件则更新图书状态和借阅记录
6. 不符合借阅条件则提示相应的错误信息

### 图书归还流程

1. 读者或管理员登录系统
2. 查找需要归还的图书记录
3. 确认归还操作
4. 系统检查是否超期
5. 如有超期，计算并显示罚款金额
6. 更新图书状态和借阅记录

## 4.3 运行时间

### 响应时间要求

1. **页面加载时间**：普通页面加载时间不超过2秒
2. **搜索响应时间**：简单搜索响应时间不超过1秒，复杂搜索不超过3秒
3. **事务处理时间**：借阅、归还等事务处理时间不超过2秒
4. **报表生成时间**：简单报表生成时间不超过5秒，复杂报表不超过30秒

### 并发处理能力

系统应能同时支持至少100个用户并发访问，在高峰期能够处理至少50个并发事务而不影响系统性能。

**5　系统数据结构设计**

## 5.1 逻辑结构设计要点

### 主要数据实体

1. **用户(User)**：存储系统用户信息，包括管理员和读者账号。
2. **图书(Book)**：存储图书的基本信息。
3. **读者(Reader)**：存储读者的详细信息。
4. **借阅(Borrow)**：记录图书借阅信息。
5. **预约(Reservation)**：记录图书预约信息。
6. **分类(Category)**：存储图书分类信息。
7. **日志(Log)**：记录系统操作日志。

### 实体关系图

```
+----------------+      +----------------+      +----------------+
|      User      |<-----|     Reader     |----->|     Borrow     |
+----------------+      +----------------+      +----------------+
        |                       |                      |
        |                       |                      |
        v                       |                      v
+----------------+              |             +----------------+
|       Log      |              |             |      Book      |
+----------------+              |             +----------------+
                                |                      ^
                                |                      |
                                v                      |
                       +----------------+      +----------------+
                       |  Reservation   |----->|    Category    |
                       +----------------+      +----------------+
```

## 5.2 物理结构设计要点

### 数据库表设计

1. **用户表(user)**
   - user_id: BIGINT (PK)
   - username: VARCHAR(50)
   - password: VARCHAR(100)
   - role: VARCHAR(20)
   - email: VARCHAR(100)
   - phone: VARCHAR(20)
   - status: TINYINT
   - create_time: DATETIME
   - last_login_time: DATETIME

2. **图书表(book)**
   - book_id: BIGINT (PK)
   - isbn: VARCHAR(20)
   - title: VARCHAR(100)
   - author: VARCHAR(100)
   - publisher: VARCHAR(100)
   - publish_date: DATE
   - category_id: BIGINT (FK)
   - price: DECIMAL(10,2)
   - description: TEXT
   - location: VARCHAR(50)
   - status: TINYINT
   - create_time: DATETIME
   - update_time: DATETIME

3. **读者表(reader)**
   - reader_id: BIGINT (PK)
   - user_id: BIGINT (FK)
   - name: VARCHAR(50)
   - gender: CHAR(1)
   - card_id: VARCHAR(50)
   - type: VARCHAR(20)
   - max_borrow_num: INT
   - max_borrow_days: INT
   - status: TINYINT
   - create_time: DATETIME
   - update_time: DATETIME

4. **借阅表(borrow)**
   - borrow_id: BIGINT (PK)
   - book_id: BIGINT (FK)
   - reader_id: BIGINT (FK)
   - borrow_date: DATE
   - due_date: DATE
   - return_date: DATE
   - status: TINYINT
   - fine: DECIMAL(10,2)
   - operator_id: BIGINT

5. **预约表(reservation)**
   - reservation_id: BIGINT (PK)
   - book_id: BIGINT (FK)
   - reader_id: BIGINT (FK)
   - reservation_date: DATE
   - expiration_date: DATE
   - status: TINYINT

6. **分类表(category)**
   - category_id: BIGINT (PK)
   - name: VARCHAR(50)
   - parent_id: BIGINT
   - description: VARCHAR(200)

7. **日志表(log)**
   - log_id: BIGINT (PK)
   - user_id: BIGINT (FK)
   - operation: VARCHAR(50)
   - content: TEXT
   - operation_time: DATETIME
   - ip: VARCHAR(50)

### 索引设计

1. **用户表(user)**
   - 主键索引：user_id
   - 唯一索引：username

2. **图书表(book)**
   - 主键索引：book_id
   - 普通索引：isbn, title, author, category_id, status

3. **读者表(reader)**
   - 主键索引：reader_id
   - 唯一索引：card_id
   - 普通索引：user_id, status

4. **借阅表(borrow)**
   - 主键索引：borrow_id
   - 普通索引：book_id, reader_id, status, borrow_date, due_date

5. **预约表(reservation)**
   - 主键索引：reservation_id
   - 普通索引：book_id, reader_id, status, reservation_date

## 5.3 数据结构与程序的关系

### 数据访问层设计

系统采用DAO（Data Access Object）模式实现数据访问层，主要包括以下DAO类：

1. **UserDAO**：负责用户数据的访问
   - 方法：findById(), findByUsername(), save(), update(), delete(), findAll()

2. **BookDAO**：负责图书数据的访问
   - 方法：findById(), findByIsbn(), findByTitle(), findByAuthor(), findByCategory(), save(), update(), delete(), findAll()

3. **ReaderDAO**：负责读者数据的访问
   - 方法：findById(), findByCardId(), findByUserId(), save(), update(), delete(), findAll()

4. **BorrowDAO**：负责借阅数据的访问
   - 方法：findById(), findByBookId(), findByReaderId(), findByStatus(), save(), update(), delete(), findAll()

5. **ReservationDAO**：负责预约数据的访问
   - 方法：findById(), findByBookId(), findByReaderId(), findByStatus(), save(), update(), delete(), findAll()

6. **CategoryDAO**：负责分类数据的访问
   - 方法：findById(), findByName(), findByParentId(), save(), update(), delete(), findAll()

7. **LogDAO**：负责日志数据的访问
   - 方法：findById(), findByUserId(), findByOperation(), save(), findAll()

### 业务逻辑层设计

业务逻辑层通过Service类实现，主要包括：

1. **UserService**：实现用户相关业务逻辑
   - 方法：login(), logout(), register(), changePassword(), updateUserInfo()

2. **BookService**：实现图书相关业务逻辑
   - 方法：addBook(), updateBook(), deleteBook(), searchBooks(), getBookDetails()

3. **ReaderService**：实现读者相关业务逻辑
   - 方法：addReader(), updateReader(), deleteReader(), searchReaders(), getReaderDetails()

4. **BorrowService**：实现借阅相关业务逻辑
   - 方法：borrowBook(), returnBook(), renewBook(), getBorrowHistory(), getOverdueBooks()

5. **ReservationService**：实现预约相关业务逻辑
   - 方法：reserveBook(), cancelReservation(), getReservationList()

6. **SystemService**：实现系统管理相关业务逻辑
   - 方法：backup(), restore(), configSystem(), managePermissions()

7. **StatisticsService**：实现统计分析相关业务逻辑
   - 方法：getBorrowStatistics(), getBookCirculationRate(), getReaderActivityAnalysis()

**6　系统出错处理设计**

## 6.1 出错信息

| 错误代码 | 错误信息 | 错误描述 | 处理方法 |
| --- | --- | --- | --- |
| E001 | 用户名或密码错误 | 用户登录时输入的用户名或密码不正确 | 提示用户重新输入正确的用户名和密码 |
| E002 | 用户账号已锁定 | 用户账号因多次登录失败或其他原因被锁定 | 提示用户联系管理员解锁账号 |
| E003 | 图书不存在 | 查询的图书不存在或已被删除 | 提示用户检查图书信息或选择其他图书 |
| E004 | 图书已借出 | 尝试借阅的图书已被其他读者借出 | 提示用户可以预约该图书或选择其他图书 |
| E005 | 读者借阅数量已达上限 | 读者已借阅的图书数量达到系统设定的上限 | 提示读者归还部分图书后再借阅新图书 |
| E006 | 读者存在逾期图书 | 读者有逾期未还的图书 | 提示读者先归还逾期图书并缴纳罚款 |
| E007 | 图书已预约 | 尝试预约的图书已被其他读者预约 | 提示用户稍后再试或选择其他图书 |
| E008 | 数据库连接失败 | 系统无法连接到数据库 | 系统自动重试连接，并记录错误日志，通知管理员 |
| E009 | 服务器内部错误 | 服务器处理请求时发生内部错误 | 系统记录错误日志，通知管理员，并提示用户稍后再试 |
| E010 | 权限不足 | 用户尝试访问没有权限的功能或资源 | 提示用户权限不足，需要更高权限才能执行该操作 |

## 6.2 补救措施

### 后备技术

1. **数据备份**：系统每天凌晨自动进行全量数据备份，每小时进行增量数据备份，备份文件存储在独立的备份服务器上。
2. **日志记录**：系统记录所有关键操作的日志，包括用户登录、图书借还、系统配置修改等，以便在系统出现问题时进行追踪和恢复。
3. **分布式存储**：关键数据采用分布式存储方式，避免单点故障导致数据丢失。

### 降效技术

1. **离线模式**：当系统网络连接不稳定时，可切换到离线模式，记录基本的借还书操作，待网络恢复后再同步到中央数据库。
2. **简化界面**：当系统负载过高时，自动切换到简化界面，减少不必要的功能和页面元素，保证核心功能的正常运行。
3. **批处理模式**：在系统高峰期，可将非紧急的数据处理任务（如统计分析、报表生成等）推迟到低峰期执行。

### 恢复及再启动技术

1. **自动重连**：当数据库连接断开时，系统自动尝试重新连接，最多尝试3次，每次间隔5秒。
2. **事务回滚**：当事务执行过程中发生错误，系统自动回滚事务，确保数据一致性。
3. **状态恢复**：系统重启后，自动恢复用户会话状态，减少用户操作中断的影响。
4. **错误隔离**：系统采用模块化设计，当某个模块出现错误时，不影响其他模块的正常运行。

## 6.3 系统维护设计

### 系统监控

1. **性能监控**：实时监控系统CPU使用率、内存使用率、数据库连接数、响应时间等指标。
2. **异常监控**：监控系统异常和错误日志，当出现严重错误时自动报警。
3. **用户行为监控**：监控用户登录、关键操作等行为，发现异常行为时进行记录和报警。

### 系统维护

1. **定期检查点**：系统每周进行一次全面检查，包括数据一致性检查、性能检查、安全检查等。
2. **自动清理**：系统自动清理过期的临时文件、日志文件和缓存数据，释放系统资源。
3. **版本更新**：系统支持在线更新，可在不影响用户使用的情况下进行小版本更新。

### 专用维护模块

1. **系统诊断模块**：提供系统自诊断功能，检查系统各组件的运行状态。
2. **数据修复模块**：提供数据一致性检查和修复功能，解决数据不一致问题。
3. **性能优化模块**：提供系统性能分析和优化建议，帮助管理员优化系统性能。
4. **安全审计模块**：提供安全审计功能，检查系统安全漏洞和异常访问行为。